version: '3.7'
services:
  auth-server:
    image: jboss/keycloak:15.0.2
    environment:
      KEYCLOAK_USER: admin
      KEYCLOAK_PASSWORD: admin
      JAVA_OPTS_APPEND: "-Dkeycloak.migration.action=import -Dkeycloak.migration.provider=dir -Dkeycloak.migration.dir=/import -Dkeycloak.migration.strategy=IGNORE_EXISTING -Dkeycloak.profile.feature.upload_scripts=enabled"
    volumes:
      - ./import:/import
      - ./api-key-module/target/deploy:/opt/jboss/keycloak/standalone/deployments/
    ports:
    - "8080:8080"
  dashboard-service:
    build: dashboard-service
    environment:
      REALM_NAME: example
    ports:
    - "8180:8180"
  rest-api-service:
    build: rest-api-service
    environment:
      REALM_NAME: example
      AUTH_SERVER_URL: auth-server:8080
    ports:
    - "8280:8280"
